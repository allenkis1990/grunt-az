<!DOCTYPE html>
<html ng-app="app">
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        .dialog{border:1px solid deepskyblue;}
        .dialog-head{height:30px;background:deepskyblue;color:#fff;}
        .dialog-body{}
        .dialog-body button{margin:50px 0px 0px 15px;}
    </style>
</head>
<body ng-controller="con">

<button ng-click="fn()">点击我出弹窗！</button>
<!--<div class="dialog" style="width:250px;height:300px;">
    <div class="dialog-head">弹窗</div>
    <div class="dialog-body">
        <button>确定</button>
        <button>取消</button>
    </div>
</div>-->


<script src="../js/angular2.min.js"></script>
<script src="../js/jquery-1.9.1.min.js"></script>
<script>
    var app=angular.module('app',[]);
    app.controller('con',function($scope,dialog){
        $scope.fn=function(){
            dialog.content(
                    {
                        width:250,
                        height:300,
                        left:'40%',
                        top:'40%',
                        title:'我是title!!',
                        content:'我是内容！！！！！！',
                        okFn:function(){
                            alert('确定！');
                        },
                        noFn:function(){
                            alert('取消！');
                        }
                    }
            );
        }

    });

    app.factory('dialog',function(){

        var that;
        var mark;
        function Dialog(options){
            console.log($(this.dom).length);
            if(mark==true){
                alert('弹窗已经出来了！！');
                return false;
            }
            that=this;
            mark=false;
            this.dom=$('<div class="dialog">'+
            '<div class="dialog-head"></div>'+
            '<div class="dialog-body">'+
            '<div class="dialog-body-content"></div>'+
            '<button class="ok">确定</button>'+
            '<button class="no">取消</button>'+
            '</div>'+
            '</div>');
            this.dom.find('.dialog-head').text(options.title);
            this.dom.find('.dialog-body-content').text(options.content);
            this.dom.css(
                {
                    width:options.width,
                    height:options.height,
                    position:'fixed',
                    left:options.left,
                    top:options.top
                }
            );
            //console.log(this.dom);
            $('body').append(this.dom);
            this.addFunction(options.okFn,options.noFn);
            mark=true;

        }

        Dialog.prototype.close=function(){
            this.dom.remove();
            mark=false;
        }


        Dialog.prototype.addFunction=function(okFn,noFn){
            this.dom.find('.ok').click(function(){
                if(okFn&&angular.isFunction(okFn)){
                    okFn();
                    that.close();
                }
            });

            this.dom.find('.no').click(function(){
                if(noFn&&angular.isFunction(noFn)){
                    noFn();
                    //console.log(that.dom.length); //1
                    that.close();
                }
            });
        }

        return {
            content:function(options){
                return new Dialog(options);
            }
        }
    });
</script>
</body>
</html>